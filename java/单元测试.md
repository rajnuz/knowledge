# 单元测试

如果需要使用到某个类中的static 或者final方法时，需要使用到powermock，并且需要在测试类中加上这个注解

**例如**B的测试类BTest中需要使用到A的静态方法，则
@SpringBootTest(classes = {RestFulWrapper.class})
@RunWith(PowerMockRunner.class)
@PrepareForTest({A.class})
@PowerMockRunnerDelegate(SpringRunner.class)
public class Btest{
}

被测试类的构造函数，Autowired成员变量等都需要在测试类中用@MockBean注入

使用import org.junit.jupiter.api.Test; 不需要测试方法和类是public的
而使用import org.junit.Test;需要测试方法和类是public的

case：
当被测试类中有：

```java
    protected static final ObjectMapper OBJECT_MAPPER = new ObjectMapper().configure(
        DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
```

这样的成员变量需要，需要在测试中mock时：

```java
       ObjectMapper objectMapper = mock(ObjectMapper.class);
        Field field =  PowerMockito.field(RestfulLoader.class,"OBJECT_MAPPER");
        field.set(RestfulLoader.class,objectMapper);
```

case：
当要使用被测试类中同类的方法时：
例如被测试类是 WebServiceWrapper：

``` java
        WebserviceWrapper webserviceWrapper = new WebserviceWrapper(wsClientCache,wsdlParser,webServiceTransformer,connectionContextCache);
        WebserviceWrapper webserviceWrapperSpy = Mockito.spy(webserviceWrapper);

        Mockito.doReturn(response).when(webserviceWrapperSpy).doSoapRequest(ArgumentMatchers.any(SoapRequest.class),
            ArgumentMatchers.any(HttpProxyConfig.class),ArgumentMatchers.any(Interceptor.class));
        webserviceWrapper.getRawTableData(dbName,rawTableName,authenticator,httpAdapterConfig,authInfo);
```
